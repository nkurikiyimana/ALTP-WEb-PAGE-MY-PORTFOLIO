<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Add blog</title>
  <link rel="stylesheet" href="admin.css">
</head>
<body>
<Style>

  .blogg{
    background-image: url(./Images/sky.jpg);
    padding: 14rem;
    background-size: cover;
  }
  #blog-form{
    padding: 4rem;
    border: solid white;
    border-radius: 5%;
    margin-top: 1rem;
   
  }
</Style>
<div class="blogg">
  <form id="blog-form">
    <label for="title">Title:</label>
    <input type="text" id="title" name="title">
    <br>
    <!-- <input type="date" id="date"> -->
    <label for="image">image:</label>
    <input type="file" id="image" name="image">
    <br>
    <label for="description">Description:</label>
    <textarea id="content" name="content"></textarea>
    <br>
    <button type="submit" id="submit-blog">Submit</button>
  </form>
  
</div>

<div id="notification">
  <p id="notification-message"></p>
</div>


  <style>
    #notification{
      background-color: blue;
      width: fit-content;
      display: block;
      margin-left: 70rem;
      float: top;

    }
#notification-message{
  font-size: 1.3rem;
  color: white;
      } 
      
    </style>

<script>

function showNotification(message) {
var notification = document.getElementById("notification");
var notificationMessage = document.getElementById("notification-message");
notificationMessage.innerHTML = message;
setTimeout(function() {
  notification.style.display = "flex";
}, 3000);
}
// Get form elements
const form2 = document.getElementById("blog-form");
const titleInput = document.getElementById("title");
// const dateInput = document.getElementById("date");
const imageInput = document.getElementById("image");
const descInput = document.getElementById("description");

// Handle form submission
form.addEventListener("submit", (e) => {
  e.preventDefault();

  // Get form data
  const title = titleInput.value;
  //const date = dateInput.value;
  const image = imageInput.value;
  const content = contentInput.value;

  // Create blog object
  const blog = {
    title: title,
    //date: date,
    image: image,
    content: content,
  };

  // Get existing blog list from local storage
  let blogList = JSON.parse(localStorage.getItem("blogList")) || [];

  // Add new blog to blog list
  blogList.push(blog);

  // Save updated blog list to local storage
  localStorage.setItem("blogList", JSON.stringify(blogList));

  
  // Redirect to blog list page
  showNotification("Blog added Succeful!")
  window.location.href = "blogs.html";


});


    // Get the form element
    const form = document.getElementById('blog-form');

    // Handle form submission
    form.addEventListener('submit', (event) => {
      // Prevent the form from submitting normally
      event.preventDefault();

      // Get the form data and file
      const formData = new FormData();
      formData.append('title', document.getElementById('title').value);
      formData.append('image', document.getElementById('image').files[0]);
      formData.append('content', document.getElementById('content').value);

      // Send the form data to the API
      fetch('http://localhost:3000/api/posts', {
        method: 'POST',
        body: formData
      })
      .then(response => {
        if (response.ok) {
          // Handle successful submission
          console.log('Form submitted successfully!');
        } else {
          // Handle submission error
          console.log(response)
          console.log('Error submitting form.');
        }
      })
      .catch(error => {
        // Handle network error
        console.log('Network error. Please try again later.');
      });
    });


</Script>
</body>
</html>